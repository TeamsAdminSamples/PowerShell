# InstalledAPPs

# Description

   Script retrieves the list of Teams apps installed for users in tenant
   
 # Prerequisites  
   
   [Create new Azure App.](https://docs.microsoft.com/en-us/graph/auth-register-app-v2)

   [How to apply permissions](https://docs.microsoft.com/en-us/graph/notifications-integration-app-registration) to your newly created App
   
   Please collect client id, client secret from created Azure App and tenant id from Azure portal
   
   ##### Required Permissions

|Permission type	|Permissions (from least to most privileged)|
|-------|----|
|Application	|TeamsAppInstallation.ReadForUser.All, TeamsAppInstallation.ReadWriteForUser.All|

# Parameters

`-AppID`

   The app's ID generated by Teams (different from the external ID)
   ***
   Type:	String[]
   ***
   Position:	Named
   ***
   Default value:	None
   ***
   Accept pipeline input:	False
   ***
   Accept wildcard characters:	False

# Inputs

Client_Id, Client_Secret, Tenantid 

# Procedure to run the script

To execute `InstalledAPPs` download/copy and paste the script into PowerShell

Provide the input parameters Client_Id, Client_Secret, TenantId and hit enter to proceed further on the script

Now the script will redirect to the web page for login

![Signin](https://github.com/Geetha63/MS-Teams-Scripts/blob/master/Images/Siginin.png)

Provide the MicrosoftTeams Administrator credentials i.e user ID and password

Press enter to continue

Once you are login it will show the below image for grant permissions for the app to perform the operations

![GrantPermission](https://github.com/Geetha63/MS-Teams-Scripts/blob/master/Images/GrantPermissions.png)

![GrantPermission](https://github.com/Geetha63/MS-Teams-Scripts/blob/master/Images/GrantPermissions2.png)

**Click Accept**

If you have provided the correct credentials it will give the success status `admin_consent = True`

![Admin Consent](https://github.com/Geetha63/MS-Teams-Scripts/blob/master/Images/AdminConsent.png)

Now press Y to proceed further in the script

Script will create 3 files i.e Userdata.csv, UserApps.csv, UserInstalledTeamsApps.csv. Userdata.csv and UserApps.csv will be used as input files to get the final output UserInstalledTeamsApps.csv
`UserInstalledTeamsApps.csv` is the final output file having installed Teams applications for each user

# Output

##### Example

| ID | Displayname |UserPrincipalName | InstalledApps |
|----|-------------|------------------|---------------|
|81701046-cb37-439b-90ce-2afd9630af7d|David Chew|davidchew@contoso.com|Activity; Calling; Teams; Saved; Files|
